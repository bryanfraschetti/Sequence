import { minDelta } from "../../../src/utils/math/minDelta";

describe("Minimum tempo difference finder function", () => {
  test("Returns song with start tempo closest to previous end tempo", () => {
    expect(
      minDelta(
        [
          {
            name: "broken pieces",
            trackId: "1m1KdWuwWHxBDV80DVLIqi",
            albumArtSrc:
              "https://i.scdn.co/image/ab67616d0000b2738cb989ddfff204b62c193716",
            artist: "LykeWyse",
            startkey: 9,
            startmode: 1,
            starttempo: 171.397,
            key: 11,
            mode: 0,
            tempo: 170.316,
            endkey: 1,
            endmode: 0,
            endtempo: 171.15,
            begTimbreCentroid: [
              27.685577777777777, -64.96764444444445, 16.43453333333333,
              -17.48628888888889, 35.24693333333334, -12.722911111111113,
              -5.750133333333334, 3.1853111111111105, -0.21557777777777756,
              1.125866666666667, -15.812044444444446, 5.238244444444446,
            ],
            endTimbreCentroid: [
              28.632318181818196, -70.08602272727272, 18.163340909090905,
              -4.900522727272727, 39.96713636363636, -19.316181818181814,
              -1.4582272727272725, 14.359113636363638, -2.5229545454545446,
              0.13943181818181796, -16.2695, 5.1721590909090915,
            ],
          },
          {
            name: "day in italy",
            trackId: "7i7qd6EScSAeoXDUjRnNuT",
            albumArtSrc:
              "https://i.scdn.co/image/ab67616d0000b27376482ac4dc7a050c825397f4",
            artist: "Å‚tchi",
            startkey: 9,
            startmode: 1,
            starttempo: 78.159,
            key: 6,
            mode: 0,
            tempo: 77.992,
            endkey: 6,
            endmode: 0,
            endtempo: 77.743,
            begTimbreCentroid: [
              29.263333333333335, -208.221625, -39.157624999999996,
              4.175166666666667, 50.560125, -12.838666666666668, -13.65275,
              14.8705, -18.001958333333334, -1.081333333333333,
              -4.981083333333333, -1.4212499999999995,
            ],
            endTimbreCentroid: [
              31.172387096774187, -127.63361290322582, -44.534903225806445,
              30.05338709677419, 31.731580645161298, -39.43722580645161,
              -32.839580645161284, -15.41348387096774, -12.85029032258064,
              8.892000000000001, -11.462806451612904, 6.462580645161291,
            ],
          },
        ],
        138.064
      )
    ).toEqual({
      min_delta: 33.333,
      song: {
        name: "broken pieces",
        trackId: "1m1KdWuwWHxBDV80DVLIqi",
        albumArtSrc:
          "https://i.scdn.co/image/ab67616d0000b2738cb989ddfff204b62c193716",
        artist: "LykeWyse",
        startkey: 9,
        startmode: 1,
        starttempo: 171.397,
        key: 11,
        mode: 0,
        tempo: 170.316,
        endkey: 1,
        endmode: 0,
        endtempo: 171.15,
        begTimbreCentroid: [
          27.685577777777777, -64.96764444444445, 16.43453333333333,
          -17.48628888888889, 35.24693333333334, -12.722911111111113,
          -5.750133333333334, 3.1853111111111105, -0.21557777777777756,
          1.125866666666667, -15.812044444444446, 5.238244444444446,
        ],
        endTimbreCentroid: [
          28.632318181818196, -70.08602272727272, 18.163340909090905,
          -4.900522727272727, 39.96713636363636, -19.316181818181814,
          -1.4582272727272725, 14.359113636363638, -2.5229545454545446,
          0.13943181818181796, -16.2695, 5.1721590909090915,
        ],
      },
    });
  });
});
